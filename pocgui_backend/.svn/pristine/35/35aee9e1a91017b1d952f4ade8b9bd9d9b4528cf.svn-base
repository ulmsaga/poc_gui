<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mobigen.cdev.mapper.mysql.module.datamanages">
  <select id="getUserInfoList" parameterType="map" resultType="com.mobigen.cdev.datagw.module.datamanages.nmsinfo.dto.UserInfoManageDto">
    <include refid='com.mobigen.cdev.mapper.mysql.core.paging.pagingPreSQL' />
    <include refid='sqlGetUserInfoList' />
    <include refid='com.mobigen.cdev.mapper.mysql.core.paging.pagingPostSQL' />
  </select>

  <select id="getUserInfoListExcel" parameterType="map" resultType="java.util.HashMap">
		<include refid='sqlGetUserInfoList' />
	</select>

  <sql id="sqlGetUserInfoList">
    SELECT
        user_id,
        user_name,
        CONCAT(SUBSTRING(phone, 1, 3), '-', SUBSTRING(phone, 4,4), '-', SUBSTRING(phone,8)) AS phone,
        email,
        team_name
      FROM
        system_manager
      WHERE 1=1 
        AND use_yn = 'Y'
        <if test = 'userId neq "" and userId neq null' >
          AND user_id like CONCAT(CONCAT('%', #{userId}), '%')
        </if>
        <if test = 'userNm neq "" and userNm neq null' >
          AND user_name like CONCAT(CONCAT('%', #{userNm}), '%')
        </if>
        <if test = 'teamInfo neq "" and teamInfo neq null' >
          AND team_name like CONCAT(CONCAT('%', #{teamInfo}), '%')
        </if>
    </sql>
</mapper>